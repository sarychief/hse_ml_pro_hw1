# AI 24 Homework 1

### Описание проекта
В рамках этого проекта была создана модель для предсказания стоимости автомобилей по их характеристикам. Также реализован REST API сервис с использованием FastAPI, который предоставляет два функционала:
1. Предсказание стоимости одного автомобиля.
2. Обработка CSV-файла с данными и генерация предсказаний для всех автомобилей.

### Проделанная работа:
1. Проведен **EDA** (исследовательский анализ данных), визуализация взаимосвязей и обработка данных.
2. Реализованы модели с различными видами регуляризации (Lasso, Ridge, ElasticNet).
3. Проведена оптимизация гиперпараметров с помощью `GridSearchCV` и кросс-валидации.
4. Введены новые признаки, включая обработку текста (названия автомобиля) и генерирование дополнительных значений, например, соотношение мощности к объему двигателя.
5. Добавлена кастомная бизнес-метрика для оценки точности модели.

### Результаты:
- **Наибольший буст качества:** 
  - Разбиение name на три признака и их дальнейшее кодирование.
- **Наименьший прирост качества:**
  - L0-регуляризация дала слабые результаты из-за трудностей с оптимизацией.

### Сложности:
- Мне кажется на каком-то этапе я совсем закимарил и регуляризация ни разу не занулила не один вес. Код вроде верный, но явно что-то не так.
- Аллерт на числовых признаках проверял 6 столбцов, когда их явно было 8. Надеюсь, критической ошибки в этом не было.

### Инструкция по запуску:
1. Клонируйте репозиторий:
    ```bash
    git clone https://github.com/sarychief/hse_ml_pro_hw1.git
    ```
2. Запустите FastAPI сервер:
    ```bash
    uvicorn service.app:app --reload
    ```
4. Примеры запросов и работа с API описаны ниже.

### Работа с API
#### Предсказание стоимости одного автомобиля:
**Запрос:**
```bash
POST http://127.0.0.1:8000/predict_item
Content-Type: application/json
Body:
{
"year": 2014,
"km_driven": 145500,
"mileage": 23.4,
"engine": 1248,
"max_power": 74.0,
"torque": 190.0,
"seats": 5,
"max_torque_rpm": 2000.0
}

